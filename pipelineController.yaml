black_check: &black_check
  taskName: black_check
  definition: jenkins/black_check.groovy
  phase: 0

build_drum: &build_drum
  taskName: build_drum
  definition: jenkins/build_drum.groovy
  phase: 1

test_integration_all_in_one: &test_integration_all_in_one
  taskName: test_integration_all_in_one
  definition: jenkins/run_integration_tests_in_a_single_container.groovy
  environment:
    PIPELINE_CONTROLLER: 1
  phase: 2

test_inference_model_templates: &test_inference_model_templates
  taskName: test_inference_model_templates
  definition: jenkins/test_inference_model_templates.groovy
  environment:
    PIPELINE_CONTROLLER: 1
  phase: 2

test_training_model_templates: &test_training_model_templates
  taskName: test_training_model_templates
  definition: jenkins/test_training_model_templates.groovy
  environment:
    PIPELINE_CONTROLLER: 1
  phase: 2

test_drop_in_envs: &test_drop_in_envs
  taskName: test_drop_in_envs
  definition: jenkins/test_drop_in_envs.groovy
  environment:
    PIPELINE_CONTROLLER: 1
  phase: 2

repositoryTasks:
  pr:
    change:
      - changedFilesRegex: '.*'
        script:
          - *black_check
          - *build_drum
          - *test_integration_all_in_one
          - *test_inference_model_templates
          - *test_training_model_templates
          - *test_drop_in_envs
