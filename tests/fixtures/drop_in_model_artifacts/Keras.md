```python
import os
import pandas as pd
from sklearn.preprocessing import LabelEncoder

# using tensorflow>=2.2.1 with built-in Keras
from tensorflow.keras.models import Sequential, load_model
from tensorflow.keras.layers import Dense, Activation, Dropout, PReLU
import tensorflow.keras.utils as np_utils
```

    2025-02-11 14:30:23.541053: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
    2025-02-11 14:30:23.544980: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
    2025-02-11 14:30:23.556061: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
    WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
    E0000 00:00:1739277023.573797 1452475 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
    E0000 00:00:1739277023.578820 1452475 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
    2025-02-11 14:30:23.596431: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
    To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.



```python
TEST_DATA_ROOT = '~/workspace/datarobot-user-models/tests/testdata'
BINARY_DATA = os.path.join(
    TEST_DATA_ROOT, 'iris_binary_training.csv'
)
REGRESSION_DATA = os.path.join(
    TEST_DATA_ROOT, 'juniors_3_year_stats_regression.csv'
)
MULTICLASS_DATA = os.path.join(
    TEST_DATA_ROOT, 'skyserver_sql2_27_2018_6_51_39_pm.csv'
)

bin_X = pd.read_csv(BINARY_DATA)
bin_y = bin_X.pop('Species')

reg_X = pd.read_csv(REGRESSION_DATA).fillna(0)
reg_y = reg_X.pop('Grade 2014')

multi_X = pd.read_csv(MULTICLASS_DATA)
multi_y = multi_X.pop('class')
```


```python
bin_model = Sequential([
    Dense(50, input_dim=bin_X.shape[1]),
    Activation('relu'),
    Dropout(0.2),
    Dense(100),
    PReLU(),
    Dense(1),
    Activation('sigmoid')
])
bin_model.compile(optimizer='rmsprop',
              loss='binary_crossentropy',
              metrics=['accuracy'])
bin_target_encoder = LabelEncoder()
bin_target_encoder.fit(bin_y)
bin_model.fit(bin_X, bin_target_encoder.transform(bin_y), epochs=10, batch_size=32)

reg_model = Sequential([
    Dense(50, input_dim=reg_X.shape[1]),
    Activation('relu'),
    Dropout(0.2),
    Dense(100),
    PReLU(),
    Dense(1),
])
reg_model.compile(optimizer='adam',
              loss='mean_squared_error',
              metrics=['accuracy'])
reg_model.fit(reg_X, reg_y, epochs=10, batch_size=32)

multi_target_encoder = LabelEncoder()
multi_target_encoder.fit(multi_y)
multi_model = Sequential()
multi_model.add(Dense(8, input_dim=multi_X.shape[1], activation='relu'))
multi_model.add(Dense(len(multi_target_encoder.classes_), activation='softmax'))
multi_model.compile(optimizer='adam',
              loss='categorical_crossentropy',
              metrics=['accuracy'])
multi_model.fit(multi_X, np_utils.to_categorical(multi_target_encoder.transform(multi_y)), epochs=10, batch_size=32)
```

    Epoch 1/10


    /tmp/venv/lib/python3.10/site-packages/keras/src/layers/core/dense.py:87: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
      super().__init__(activity_regularizer=activity_regularizer, **kwargs)
    2025-02-11 14:30:25.320179: E external/local_xla/xla/stream_executor/cuda/cuda_driver.cc:152] failed call to cuInit: INTERNAL: CUDA error: Failed call to cuInit: UNKNOWN ERROR (303)
    2025-02-11 14:30:25.320203: I external/local_xla/xla/stream_executor/cuda/cuda_diagnostics.cc:137] retrieving CUDA diagnostic information for host: zohar-ubuntu
    2025-02-11 14:30:25.320208: I external/local_xla/xla/stream_executor/cuda/cuda_diagnostics.cc:144] hostname: zohar-ubuntu
    2025-02-11 14:30:25.320269: I external/local_xla/xla/stream_executor/cuda/cuda_diagnostics.cc:168] libcuda reported version is: NOT_FOUND: was unable to find libcuda.so DSO loaded into this program
    2025-02-11 14:30:25.320298: I external/local_xla/xla/stream_executor/cuda/cuda_diagnostics.cc:172] kernel reported version is: 550.120.0


    [1m1/4[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m2s[0m 741ms/step - accuracy: 0.5938 - loss: 1.7249

    [1m4/4[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m1s[0m 7ms/step - accuracy: 0.6439 - loss: 1.1901  


    Epoch 2/10


    [1m1/4[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 20ms/step - accuracy: 0.7188 - loss: 0.8118

    [1m4/4[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 7ms/step - accuracy: 0.7671 - loss: 0.6808 


    Epoch 3/10


    [1m1/4[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 17ms/step - accuracy: 0.7812 - loss: 0.5190

    [1m4/4[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 6ms/step - accuracy: 0.7425 - loss: 0.6462 


    Epoch 4/10


    [1m1/4[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 15ms/step - accuracy: 0.6562 - loss: 0.6513

    [1m4/4[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 6ms/step - accuracy: 0.6763 - loss: 0.6641 


    Epoch 5/10


    [1m1/4[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 21ms/step - accuracy: 0.8750 - loss: 0.4543

    [1m4/4[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 6ms/step - accuracy: 0.8407 - loss: 0.4536 


    Epoch 6/10


    [1m1/4[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 17ms/step - accuracy: 0.7500 - loss: 0.4201

    [1m4/4[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 6ms/step - accuracy: 0.7562 - loss: 0.4585 


    Epoch 7/10


    [1m1/4[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 16ms/step - accuracy: 0.8750 - loss: 0.3604

    [1m4/4[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 7ms/step - accuracy: 0.8480 - loss: 0.4009 


    Epoch 8/10


    [1m1/4[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 17ms/step - accuracy: 0.8125 - loss: 0.5134

    [1m4/4[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 6ms/step - accuracy: 0.8559 - loss: 0.4314 


    Epoch 9/10


    [1m1/4[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 15ms/step - accuracy: 0.9688 - loss: 0.2045

    [1m4/4[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 6ms/step - accuracy: 0.9039 - loss: 0.2653 


    Epoch 10/10


    [1m1/4[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 16ms/step - accuracy: 0.8750 - loss: 0.3552

    [1m4/4[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 8ms/step - accuracy: 0.8830 - loss: 0.3377 


    Epoch 1/10


    /tmp/venv/lib/python3.10/site-packages/keras/src/layers/core/dense.py:87: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
      super().__init__(activity_regularizer=activity_regularizer, **kwargs)


    [1m 1/47[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m56s[0m 1s/step - accuracy: 0.0000e+00 - loss: 1428.1855

    [1m31/47[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.0000e+00 - loss: 561.4589 

    [1m47/47[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m1s[0m 2ms/step - accuracy: 0.0000e+00 - loss: 471.9584


    Epoch 2/10


    [1m 1/47[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 16ms/step - accuracy: 0.0000e+00 - loss: 117.7597

    [1m38/47[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 1ms/step - accuracy: 0.0000e+00 - loss: 164.0912 

    [1m47/47[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.0000e+00 - loss: 161.3587


    Epoch 3/10


    [1m 1/47[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 27ms/step - accuracy: 0.0000e+00 - loss: 68.1414

    [1m29/47[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.0000e+00 - loss: 128.0453

    [1m47/47[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.0000e+00 - loss: 128.9018


    Epoch 4/10


    [1m 1/47[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 29ms/step - accuracy: 0.0000e+00 - loss: 109.2826

    [1m23/47[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.0000e+00 - loss: 142.2675 

    [1m44/47[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 2ms/step - accuracy: 0.0000e+00 - loss: 141.2607

    [1m47/47[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.0000e+00 - loss: 140.6008


    Epoch 5/10


    [1m 1/47[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 32ms/step - accuracy: 0.0000e+00 - loss: 66.3914

    [1m17/47[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 3ms/step - accuracy: 0.0000e+00 - loss: 120.4241

    [1m36/47[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 3ms/step - accuracy: 0.0000e+00 - loss: 124.4273

    [1m47/47[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3ms/step - accuracy: 0.0000e+00 - loss: 125.8403


    Epoch 6/10


    [1m 1/47[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 22ms/step - accuracy: 0.0000e+00 - loss: 196.0650

    [1m27/47[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.0000e+00 - loss: 133.4320 

    [1m47/47[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.0000e+00 - loss: 133.0234


    Epoch 7/10


    [1m 1/47[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 20ms/step - accuracy: 0.0000e+00 - loss: 107.0523

    [1m27/47[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.0000e+00 - loss: 129.1269 

    [1m47/47[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.0000e+00 - loss: 129.3331


    Epoch 8/10


    [1m 1/47[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 19ms/step - accuracy: 0.0000e+00 - loss: 80.2727

    [1m34/47[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.0000e+00 - loss: 147.1817

    [1m47/47[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.0000e+00 - loss: 143.5046


    Epoch 9/10


    [1m 1/47[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 25ms/step - accuracy: 0.0000e+00 - loss: 146.4314

    [1m38/47[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 1ms/step - accuracy: 0.0000e+00 - loss: 126.8036 

    [1m47/47[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.0000e+00 - loss: 126.3942


    Epoch 10/10


    [1m 1/47[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 17ms/step - accuracy: 0.0000e+00 - loss: 236.5764

    [1m35/47[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 1ms/step - accuracy: 0.0000e+00 - loss: 121.0991 

    [1m47/47[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step - accuracy: 0.0000e+00 - loss: 120.8583


    Epoch 1/10


    /tmp/venv/lib/python3.10/site-packages/keras/src/layers/core/dense.py:87: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
      super().__init__(activity_regularizer=activity_regularizer, **kwargs)


    [1m  1/313[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m4:15[0m 820ms/step - accuracy: 0.0625 - loss: 923316951009198080.0000

    [1m 22/313[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.1029 - loss: 903477363197607936.0000    

    [1m 35/313[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 3ms/step - accuracy: 0.1060 - loss: 860542739803013120.0000

    [1m 47/313[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m0s[0m 3ms/step - accuracy: 0.1084 - loss: 828008603053981696.0000

    [1m 58/313[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.1102 - loss: 802890397356392448.0000

    [1m 68/313[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.1113 - loss: 781786783489720320.0000

    [1m 85/313[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.1125 - loss: 749430286588051456.0000

    [1m105/313[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.1133 - loss: 714935858045648896.0000

    [1m124/313[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 3ms/step - accuracy: 0.1140 - loss: 684026455885086720.0000

    [1m140/313[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 3ms/step - accuracy: 0.1150 - loss: 658941235536330752.0000

    [1m159/313[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 3ms/step - accuracy: 0.1183 - loss: 630196703051382784.0000

    [1m177/313[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 3ms/step - accuracy: 0.1244 - loss: 604308564336443392.0000

    [1m210/313[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m0s[0m 3ms/step - accuracy: 0.1437 - loss: 561153351421526016.0000

    [1m255/313[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 3ms/step - accuracy: 0.1750 - loss: 511119903000887296.0000

    [1m311/313[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 2ms/step - accuracy: 0.2125 - loss: 460486361749651456.0000

    [1m313/313[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m2s[0m 2ms/step - accuracy: 0.2144 - loss: 458079427717234688.0000


    Epoch 2/10


    [1m  1/313[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m5s[0m 18ms/step - accuracy: 0.7500 - loss: 4531319346298880.0000

    [1m 59/313[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m0s[0m 872us/step - accuracy: 0.6503 - loss: 4425975609688064.0000

    [1m121/313[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 845us/step - accuracy: 0.6464 - loss: 4379632912564224.0000

    [1m182/313[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 839us/step - accuracy: 0.6449 - loss: 4295707640987648.0000

    [1m239/313[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 851us/step - accuracy: 0.6454 - loss: 4208959502155776.0000

    [1m297/313[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 854us/step - accuracy: 0.6454 - loss: 4133312511606784.0000

    [1m313/313[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 899us/step - accuracy: 0.6454 - loss: 4110048821248000.0000


    Epoch 3/10


    [1m  1/313[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m5s[0m 16ms/step - accuracy: 0.5312 - loss: 2359806430019584.0000

    [1m 60/313[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m0s[0m 858us/step - accuracy: 0.6560 - loss: 2363383064035328.0000

    [1m 99/313[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 1ms/step - accuracy: 0.6646 - loss: 2416541605822464.0000  

    [1m120/313[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 1ms/step - accuracy: 0.6653 - loss: 2434645161410560.0000

    [1m138/313[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 1ms/step - accuracy: 0.6657 - loss: 2460916134182912.0000

    [1m155/313[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.6659 - loss: 2472556569296896.0000

    [1m174/313[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.6664 - loss: 2473919952977920.0000

    [1m195/313[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.6668 - loss: 2467187323305984.0000

    [1m223/313[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.6668 - loss: 2457398019096576.0000

    [1m250/313[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.6668 - loss: 2440666705559552.0000

    [1m278/313[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m0s[0m 2ms/step - accuracy: 0.6667 - loss: 2419806049402880.0000

    [1m312/313[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 2ms/step - accuracy: 0.6664 - loss: 2399147793580032.0000

    [1m313/313[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m1s[0m 2ms/step - accuracy: 0.6664 - loss: 2397991373635584.0000


    Epoch 4/10


    [1m  1/313[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m6s[0m 20ms/step - accuracy: 0.8438 - loss: 235193482870784.0000

    [1m 42/313[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 1ms/step - accuracy: 0.6955 - loss: 1480686485635072.0000

    [1m 76/313[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m0s[0m 1ms/step - accuracy: 0.6847 - loss: 1608959576244224.0000

    [1m111/313[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 1ms/step - accuracy: 0.6814 - loss: 1644436677197824.0000

    [1m152/313[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 1ms/step - accuracy: 0.6797 - loss: 1649624326602752.0000

    [1m203/313[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 1ms/step - accuracy: 0.6778 - loss: 1627338278174720.0000

    [1m258/313[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 1ms/step - accuracy: 0.6768 - loss: 1624430987968512.0000

    [1m313/313[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.6765 - loss: 1628174454620160.0000


    Epoch 5/10


    [1m  1/313[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m4s[0m 16ms/step - accuracy: 0.7500 - loss: 1290535666974720.0000

    [1m 59/313[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m0s[0m 868us/step - accuracy: 0.6618 - loss: 1310934614147072.0000

    [1m104/313[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 985us/step - accuracy: 0.6668 - loss: 1304439012982784.0000

    [1m146/313[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 1ms/step - accuracy: 0.6692 - loss: 1315233339539456.0000  

    [1m201/313[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 1ms/step - accuracy: 0.6712 - loss: 1330487050108928.0000

    [1m258/313[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 985us/step - accuracy: 0.6728 - loss: 1333391387525120.0000

    [1m312/313[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 977us/step - accuracy: 0.6745 - loss: 1328127234015232.0000

    [1m313/313[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.6745 - loss: 1327866180534272.0000  


    Epoch 6/10


    [1m  1/313[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m4s[0m 16ms/step - accuracy: 0.7500 - loss: 1955587730440192.0000

    [1m 63/313[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m0s[0m 816us/step - accuracy: 0.7144 - loss: 1509943534419968.0000

    [1m117/313[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 867us/step - accuracy: 0.7022 - loss: 1287964726394880.0000

    [1m178/313[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 854us/step - accuracy: 0.6962 - loss: 1270391196614656.0000

    [1m240/313[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 845us/step - accuracy: 0.6927 - loss: 1267584032833536.0000

    [1m298/313[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 851us/step - accuracy: 0.6905 - loss: 1265208244830208.0000

    [1m313/313[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 891us/step - accuracy: 0.6900 - loss: 1263615617269760.0000


    Epoch 7/10


    [1m  1/313[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m4s[0m 15ms/step - accuracy: 0.8750 - loss: 423747915874304.0000

    [1m 56/313[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m0s[0m 911us/step - accuracy: 0.6814 - loss: 1523449730170880.0000

    [1m116/313[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 875us/step - accuracy: 0.6824 - loss: 1379212514557952.0000

    [1m180/313[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 845us/step - accuracy: 0.6823 - loss: 1266359967154176.0000

    [1m236/313[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 860us/step - accuracy: 0.6811 - loss: 1207681721303040.0000

    [1m278/313[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m0s[0m 915us/step - accuracy: 0.6795 - loss: 1191431712538624.0000

    [1m310/313[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 986us/step - accuracy: 0.6786 - loss: 1195204572872704.0000

    [1m313/313[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.6785 - loss: 1196046252244992.0000  


    Epoch 8/10


    [1m  1/313[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m9s[0m 31ms/step - accuracy: 0.7812 - loss: 788719204302848.0000

    [1m 32/313[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.7401 - loss: 1975042321678336.0000

    [1m 63/313[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.7149 - loss: 1692241273815040.0000

    [1m 92/313[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.7072 - loss: 1576177433051136.0000

    [1m126/313[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.7013 - loss: 1467352759664640.0000

    [1m160/313[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.6969 - loss: 1384510490935296.0000

    [1m187/313[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.6936 - loss: 1337271353606144.0000

    [1m220/313[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.6906 - loss: 1289025046446080.0000

    [1m262/313[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.6883 - loss: 1242427335639040.0000

    [1m304/313[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 2ms/step - accuracy: 0.6865 - loss: 1217692082110464.0000

    [1m313/313[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m1s[0m 2ms/step - accuracy: 0.6860 - loss: 1212927486984192.0000


    Epoch 9/10


    [1m  1/313[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m6s[0m 19ms/step - accuracy: 0.8750 - loss: 869750204792832.0000

    [1m 42/313[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 1ms/step - accuracy: 0.7035 - loss: 1321110868066304.0000

    [1m 94/313[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 1ms/step - accuracy: 0.6958 - loss: 1089104787800064.0000

    [1m146/313[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 1ms/step - accuracy: 0.6908 - loss: 1030221994131456.0000

    [1m188/313[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 1ms/step - accuracy: 0.6880 - loss: 1002560391479296.0000

    [1m244/313[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 1ms/step - accuracy: 0.6846 - loss: 980404332920832.0000 

    [1m283/313[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 1ms/step - accuracy: 0.6831 - loss: 979653384732672.0000

    [1m313/313[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1ms/step - accuracy: 0.6823 - loss: 986761891151872.0000


    Epoch 10/10


    [1m  1/313[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m6s[0m 20ms/step - accuracy: 0.7812 - loss: 463804928360448.0000

    [1m 33/313[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.6787 - loss: 597118834180096.0000 

    [1m 81/313[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 1ms/step - accuracy: 0.6796 - loss: 750888998141952.0000

    [1m117/313[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 1ms/step - accuracy: 0.6808 - loss: 758776705581056.0000

    [1m140/313[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 1ms/step - accuracy: 0.6795 - loss: 759003936194560.0000

    [1m156/313[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.6788 - loss: 767263292522496.0000

    [1m173/313[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.6785 - loss: 780616211628032.0000

    [1m201/313[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.6776 - loss: 808416192757760.0000

    [1m229/313[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.6769 - loss: 841323695308800.0000

    [1m246/313[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 2ms/step - accuracy: 0.6765 - loss: 860903847231488.0000

    [1m269/313[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m0s[0m 2ms/step - accuracy: 0.6759 - loss: 884215453319168.0000

    [1m297/313[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 2ms/step - accuracy: 0.6754 - loss: 905552515301376.0000

    [1m313/313[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m1s[0m 2ms/step - accuracy: 0.6753 - loss: 915578780909568.0000





    <keras.src.callbacks.history.History at 0x706784505180>




```python
print(bin_model.predict(pd.DataFrame(bin_X)))
print(reg_model.predict(pd.DataFrame(reg_X)))
print(multi_model.predict(pd.DataFrame(multi_X)))
```

    [1m1/4[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 90ms/step

    [1m4/4[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 21ms/step

    [1m4/4[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 27ms/step


    [[0.02779404]
     [0.03588174]
     [0.04144409]
     [0.05069022]
     [0.04380393]
     [0.03880193]
     [0.08277724]
     [0.08449268]
     [0.14780703]
     [0.13095973]
     [0.1072793 ]
     [0.16595115]
     [0.19992554]
     [0.25555167]
     [0.14634201]
     [0.15422742]
     [0.19780077]
     [0.2505769 ]
     [0.21726541]
     [0.2769585 ]
     [0.29006815]
     [0.31282887]
     [0.38344342]
     [0.39060068]
     [0.44995153]
     [0.4893678 ]
     [0.485468  ]
     [0.48855612]
     [0.5254908 ]
     [0.6207683 ]
     [0.64786035]
     [0.5959883 ]
     [0.5859966 ]
     [0.57706076]
     [0.7418964 ]
     [0.74844897]
     [0.71349716]
     [0.807152  ]
     [0.85526216]
     [0.8931468 ]
     [0.9277032 ]
     [0.9211205 ]
     [0.97200423]
     [0.9536292 ]
     [0.97210014]
     [0.9621681 ]
     [0.98671085]
     [0.9706102 ]
     [0.98698986]
     [0.9920654 ]
     [0.9849849 ]
     [0.9899571 ]
     [0.9879906 ]
     [0.9912308 ]
     [0.9871269 ]
     [0.9930132 ]
     [0.9940875 ]
     [0.9949989 ]
     [0.99612075]
     [0.9949118 ]
     [0.9958558 ]
     [0.99656516]
     [0.9968136 ]
     [0.996703  ]
     [0.9967317 ]
     [0.9971538 ]
     [0.9973977 ]
     [0.99833375]
     [0.02779404]
     [0.03588174]
     [0.04144409]
     [0.05069022]
     [0.04380393]
     [0.03880193]
     [0.08277724]
     [0.08449268]
     [0.14780703]
     [0.13095973]
     [0.1072793 ]
     [0.16595115]
     [0.19992554]
     [0.25555167]
     [0.14634201]
     [0.15422742]
     [0.19780077]
     [0.2505769 ]
     [0.21726541]
     [0.2769585 ]
     [0.29006815]
     [0.31282887]
     [0.38344342]
     [0.39060068]
     [0.44995153]
     [0.4893678 ]
     [0.48546815]
     [0.48855612]
     [0.5254908 ]
     [0.6207683 ]
     [0.6478606 ]
     [0.5959883 ]
     [0.5859966 ]
     [0.57706076]
     [0.99656516]
     [0.9968136 ]
     [0.996703  ]
     [0.9967317 ]
     [0.9971538 ]
     [0.9973977 ]
     [0.99833375]]
    [1m 1/47[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m2s[0m 50ms/step

    [1m47/47[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step 

    [1m47/47[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 2ms/step


    [[24.512632]
     [24.521473]
     [25.99413 ]
     ...
     [28.105919]
     [19.978878]
     [28.46393 ]]


    [1m  1/313[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m9s[0m 31ms/step

    [1m 91/313[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 557us/step

    [1m195/313[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 519us/step

    [1m273/313[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m0s[0m 557us/step

    [1m313/313[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 679us/step

    [1m313/313[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 728us/step


    [[0.         0.         0.99999994]
     [0.99999994 0.         0.        ]
     [0.99999994 0.         0.        ]
     ...
     [0.         0.         0.99999994]
     [0.99999994 0.         0.        ]
     [0.99999994 0.         0.        ]]



```python
FIXTURE_ROOT = '~/workspace/datarobot-user-models/tests/fixtures/drop_in_model_artifacts'
bin_model.save(os.path.expanduser(os.path.join(FIXTURE_ROOT, 'keras_bin.h5')))
reg_model.save(os.path.expanduser(os.path.join(FIXTURE_ROOT, 'keras_reg.h5')))
multi_model.save(os.path.expanduser(os.path.join(FIXTURE_ROOT, 'keras_multi.h5')))
```

    WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 


    WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 


    WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 



```python

```
