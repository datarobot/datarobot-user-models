version: '3.8'

services:
  drum:
    image: docker.io/oleksandrromaniukdr/nim:drum_dev_env_8
    environment:
      OPENAI_HOST: openai
      TARGET_TYPE: textgeneration
      TARGET_NAME: prompt
    ports:
      - 8080:8080
    networks:
      - my_network

  openai:
    image: nvcr.io/nim/meta/llama-3.1-8b-instruct:1.3.3
    environment:
      - NGC_API_KEY=${NGC_API_KEY}
    ports:
      - 8000:8000
    networks:
      - my_network
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu]

networks:
  my_network:
    driver: bridge